<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Page</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='review_page.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <div class="container">
        <!-- 리뷰 요약 -->
        <div class="review-summary">
            리뷰 ({{ reviews|length }})
            <span class="stars">
                {% for i in range(5) %}
                <img src="{{ url_for('static', filename='images/greenclover.png') }}" alt="greenclover" width="20" height="20">
                {% endfor %}
            </span>
        </div>
        <hr class="divider">

        <!-- 리뷰 이미지 섹션 -->
        <div class="review-images">
            {% for review in reviews %}
                {% if review.image_url %}
                <div class="review-image">
                    <img src="/{{ review.image_url }}" alt="Review Image" class="review-thumbnail" width="100%" height="100%">
                </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- 정렬 버튼 -->
        <div class="review-options">
            <div class="sort-buttons">
                <a href="{{ url_for('view_review_page', name=name, sort='latest', page=current_page) }}" 
                    class="{% if request.args.get('sort') == 'latest' %}active{% endif %}">최신순</a>
                <a href="{{ url_for('view_review_page', name=name, sort='best', page=current_page) }}" 
                    class="{% if request.args.get('sort') == 'best' %}active{% endif %}">별점순</a>
            </div>
        </div>

        <!-- 리뷰 목록 -->
        {% if reviews %}
            {% for review in reviews %}
            <div class="review-item">
                <div class="left">
                    <div class="content">
                        <div class="writer">
                            {{ review.writer }}
                            <span class="stars">
                                {% for i in range(review.star) %}
                                <img src="{{ url_for('static', filename='images/greenclover.png') }}" alt="greenclover" width="20" height="20">
                                {% endfor %}
                            </span>
                        </div>
                        <div>{{ review.info }}</div>
                    </div>
                </div>
                <div class="right">
                    <a href="{{ url_for('review_detail', item_name=name, review_id=review.name) }}">
                        <div class="avatar">
                            {% if review.image_url %}
                            <img src="/{{ review.image_url }}" alt="Review Image" class="review-avatar-img" width="100%" height="100%">
                            {% endif %}
                        </div>
                    </a>
                    <div class="details">
                        <div class="date">{{ review.date }}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
        <p style="text-align: center;">등록된 리뷰가 없습니다.</p>
        {% endif %}

        <!-- 리뷰 작성 버튼 -->
        <div class="review-button-container">
            <button class="write-review" onclick="location.href='/reg_review_init/{{name}}/';">리뷰 작성하기</button>
        </div>

        <!-- 페이지네이션 -->
        <footer>
            <div class="pagination" style="justify-self: center;">
                {% if current_page > 1 %}
                <a href="{{ url_for('view_review_page', name=name, page=current_page - 1) }}" class="prev" style="color: gray;">← Previous</a>
                {% endif %}
                
                {% for i in range(1, total_pages + 1) %}
                <a href="{{ url_for('view_review_page', name=name, page=i) }}" class="page {% if current_page == i %}active{% endif %}">{{ i }}</a>
                {% endfor %}

                {% if current_page < total_pages %}
                <a href="{{ url_for('view_review_page', name=name, page=current_page + 1) }}" class="next" style="color: #006400;">Next →</a>
                {% endif %}
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='review_page.js') }}"></script>
</body>
</html>